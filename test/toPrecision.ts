import * as assert from 'assert'
import { parse, PrecisionOptions, toPrecision } from '../src/Big'
import { pipe } from 'fp-ts/lib/function'

function testToPrecision(
  expected: string,
  value: string | number,
  po: Partial<PrecisionOptions> = {}
) {
  it(`Big.js test: ${value} to precision of ${
    po.sd ?? 'undefined'
  } significant digits using RoundingMode ${po.rm ?? 'undefined'}`, () => {
    assert.strictEqual(pipe(value, parse, toPrecision(po)), expected)
  })
}

describe('toPrecision', () => {
  testToPrecision('0', 0, { rm: 1 })

  testToPrecision('0', -0, { rm: 1 })

  testToPrecision('0', 0, { sd: 1, rm: 1 })

  testToPrecision('0', -0, { sd: 1, rm: 1 })

  testToPrecision('0.0', 0, { sd: 2, rm: 1 })

  testToPrecision('0.0', -0, { sd: 2, rm: 1 })

  testToPrecision('1e+27', '1.2345e+27', { sd: 1, rm: 1 })

  testToPrecision('1.2e+27', '1.2345e+27', { sd: 2, rm: 1 })

  testToPrecision('1.23e+27', '1.2345e+27', { sd: 3, rm: 1 })

  testToPrecision('1.235e+27', '1.2345e+27', { sd: 4, rm: 1 })

  testToPrecision('1.2345e+27', '1.2345e+27', { sd: 5, rm: 1 })

  testToPrecision('1.23450e+27', '1.2345e+27', { sd: 6, rm: 1 })

  testToPrecision('1.234500e+27', '1.2345e+27', { sd: 7, rm: 1 })

  testToPrecision('-1e+27', '-1.2345e+27', { sd: 1, rm: 1 })

  testToPrecision('-1.2e+27', '-1.2345e+27', { sd: 2, rm: 1 })

  testToPrecision('-1.23e+27', '-1.2345e+27', { sd: 3, rm: 1 })

  testToPrecision('-1.235e+27', '-1.2345e+27', { sd: 4, rm: 1 })

  testToPrecision('-1.2345e+27', '-1.2345e+27', { sd: 5, rm: 1 })

  testToPrecision('-1.23450e+27', '-1.2345e+27', { sd: 6, rm: 1 })

  testToPrecision('-1.234500e+27', '-1.2345e+27', { sd: 7, rm: 1 })

  testToPrecision('7', 7, { sd: 1, rm: 1 })

  testToPrecision('7.0', 7, { sd: 2, rm: 1 })

  testToPrecision('7.00', 7, { sd: 3, rm: 1 })

  testToPrecision('-7', -7, { sd: 1, rm: 1 })

  testToPrecision('-7.0', -7, { sd: 2, rm: 1 })

  testToPrecision('-7.00', -7, { sd: 3, rm: 1 })

  testToPrecision('9e+1', 91, { sd: 1, rm: 1 })

  testToPrecision('91', 91, { sd: 2, rm: 1 })

  testToPrecision('91.0', 91, { sd: 3, rm: 1 })

  testToPrecision('91.00', 91, { sd: 4, rm: 1 })

  testToPrecision('-9e+1', -91, { sd: 1, rm: 1 })

  testToPrecision('-91', -91, { sd: 2, rm: 1 })

  testToPrecision('-91.0', -91, { sd: 3, rm: 1 })

  testToPrecision('-91.00', -91, { sd: 4, rm: 1 })

  testToPrecision('9e+1', 91.1234, { sd: 1, rm: 1 })

  testToPrecision('91', 91.1234, { sd: 2, rm: 1 })

  testToPrecision('91.1', 91.1234, { sd: 3, rm: 1 })

  testToPrecision('91.12', 91.1234, { sd: 4, rm: 1 })

  testToPrecision('91.123', 91.1234, { sd: 5, rm: 1 })

  testToPrecision('91.1234', 91.1234, { sd: 6, rm: 1 })

  testToPrecision('91.12340', 91.1234, { sd: 7, rm: 1 })

  testToPrecision('91.123400', 91.1234, { sd: 8, rm: 1 })

  testToPrecision('-9e+1', -91.1234, { sd: 1, rm: 1 })

  testToPrecision('-91', -91.1234, { sd: 2, rm: 1 })

  testToPrecision('-91.1', -91.1234, { sd: 3, rm: 1 })

  testToPrecision('-91.12', -91.1234, { sd: 4, rm: 1 })

  testToPrecision('-91.123', -91.1234, { sd: 5, rm: 1 })

  testToPrecision('-91.1234', -91.1234, { sd: 6, rm: 1 })

  testToPrecision('-91.12340', -91.1234, { sd: 7, rm: 1 })

  testToPrecision('-91.123400', -91.1234, { sd: 8, rm: 1 })

  testToPrecision('5.55000000000000e-7', 0.000000555, { sd: 15, rm: 1 })

  testToPrecision('-5.55000000000000e-7', -0.000000555, { sd: 15, rm: 1 })

  testToPrecision('-1.2e-9', -0.0000000012345, { sd: 2, rm: 1 })

  testToPrecision('-1.2e-8', -0.000000012345, { sd: 2, rm: 1 })

  testToPrecision('-1.2e-7', -0.00000012345, { sd: 2, rm: 1 })

  testToPrecision('1e+8', 123456789, { sd: 1, rm: 1 })

  testToPrecision('123456789', 123456789, { sd: 9, rm: 1 })

  testToPrecision('1.2345679e+8', 123456789, { sd: 8, rm: 1 })

  testToPrecision('1.234568e+8', 123456789, { sd: 7, rm: 1 })

  testToPrecision('-1.234568e+8', -123456789, { sd: 7, rm: 1 })

  testToPrecision('-0.0000012', -0.0000012345, { sd: 2, rm: 1 })

  testToPrecision('-0.000012', -0.000012345, { sd: 2, rm: 1 })

  testToPrecision('-0.00012', -0.00012345, { sd: 2, rm: 1 })

  testToPrecision('-0.0012', -0.0012345, { sd: 2, rm: 1 })

  testToPrecision('-0.012', -0.012345, { sd: 2, rm: 1 })

  testToPrecision('-0.12', -0.12345, { sd: 2, rm: 1 })

  testToPrecision('-1.2', -1.2345, { sd: 2, rm: 1 })

  testToPrecision('-12', -12.345, { sd: 2, rm: 1 })

  testToPrecision('-1.2e+2', -123.45, { sd: 2, rm: 1 })

  testToPrecision('-1.2e+3', -1234.5, { sd: 2, rm: 1 })

  testToPrecision('-1.2e+4', -12345, { sd: 2, rm: 1 })

  testToPrecision('-1.235e+4', -12345.67, { sd: 4, rm: 1 })

  testToPrecision('-1.234e+4', -12344.67, { sd: 4, rm: 1 })

  testToPrecision('1.3', 1.25, { sd: 2, rm: 1 })

  testToPrecision('1.4', 1.35, { sd: 2, rm: 1 })

  testToPrecision('1e+4', 9631.01, { sd: 1, rm: 1 })

  testToPrecision('1.0e+7', 9950095.87, { sd: 2, rm: 1 })

  testToPrecision('1e+1', '9.856839969', { sd: 1, rm: 1 })

  testToPrecision('1e+2', '97.504', { sd: 1, rm: 1 })

  testToPrecision('1e+5', 97802.6, { sd: 1, rm: 1 })

  testToPrecision('1e+1', 9.9617, { sd: 1, rm: 1 })

  testToPrecision('1e+3', 989.2, { sd: 1, rm: 1 })

  testToPrecision('1.0e+5', 99576, { sd: 2, rm: 1 })

  testToPrecision('1e+8', '96236483.87', { sd: 1, rm: 1 })

  testToPrecision('-844789036.5239726', '-844789036.52397268892', {
    sd: 16,
    rm: 0
  })

  testToPrecision(
    '-5056.20629012767878749185273209679064306054',
    '-5056.206290127678787491852732096790643060542',
    { sd: 42, rm: 0 }
  )

  testToPrecision(
    '-0.3287519131314873763501859870298952500',
    '-0.32875191313148737635018598702989525',
    { sd: 37, rm: 0 }
  )

  testToPrecision('-60729764', '-60729764', { sd: 8, rm: 0 })

  testToPrecision('-7.622e-14', '-0.00000000000007622481594531380999826456196664586', {
    sd: 4,
    rm: 0
  })

  testToPrecision('-4686402261639729535.736324492474', '-4686402261639729535.7363244924747488', {
    sd: 31,
    rm: 0
  })

  testToPrecision('-2.0', '-2', { sd: 2, rm: 0 })

  testToPrecision('0.0000807327587149839799300000', '0.00008073275871498397993', { sd: 24, rm: 0 })

  testToPrecision('-6.000000e-8', '-0.00000006', { sd: 7, rm: 0 })

  testToPrecision('-3.83574993e+11', '-383574993535', { sd: 9, rm: 0 })

  testToPrecision('7.6987000000000000e-14', '0.000000000000076987', {
    sd: 17,
    rm: 0
  })

  testToPrecision(
    '80928866804.6112050947427973',
    '80928866804.6112050947427973864826014844575374353',
    { sd: 27, rm: 0 }
  )

  testToPrecision('-0.00730140', '-0.0073014067221009206110062377503733', {
    sd: 6,
    rm: 0
  })

  testToPrecision(
    '2.72104773884160491036088486e+30',
    '2721047738841604910360884862459.4086993273252009015',
    { sd: 27, rm: 0 }
  )

  testToPrecision('3.008780781917733594e+25', '30087807819177335941398228.1424107931203', {
    sd: 19,
    rm: 0
  })

  testToPrecision(
    '-1.31528920779613669158250146972297797867760000000000000000000e-19',
    '-0.00000000000000000013152892077961366915825014697229779786776',
    { sd: 60, rm: 0 }
  )

  testToPrecision('-8.5e+11', '-858982311008.257025719798657844609315293821', {
    sd: 2,
    rm: 0
  })

  testToPrecision('-3.6312e-12', '-0.0000000000036312827608449878', {
    sd: 5,
    rm: 0
  })

  testToPrecision('-0.0060000', '-0.006', { sd: 5, rm: 0 })

  testToPrecision('-1e+1', '-12', { sd: 1, rm: 0 })

  testToPrecision('5.779447e+14', '577944759667712', { sd: 7, rm: 0 })

  testToPrecision(
    '-8.753124714248104872487955947563035887800000000000e-13',
    '-0.00000000000087531247142481048724879559475630358878',
    { sd: 49, rm: 0 }
  )

  testToPrecision('0.000736948830704113912', '0.000736948830704113912970821957479', {
    sd: 18,
    rm: 0
  })

  testToPrecision('-4.65727e+23', '-465727983501322687372765', {
    sd: 6,
    rm: 0
  })

  testToPrecision('-0.00000332331666628036603', '-0.000003323316666280366035430077076052', {
    sd: 18,
    rm: 0
  })

  testToPrecision('3.533702e-8', '0.00000003533702791135712510338001418872124', { sd: 7, rm: 0 })

  testToPrecision('-0.04340', '-0.0434', { sd: 4, rm: 0 })

  testToPrecision(
    '-597340.278566069086858587852236235470',
    '-597340.2785660690868585878522362354706741',
    { sd: 36, rm: 0 }
  )

  testToPrecision('6.000e-8', '0.00000006', { sd: 4, rm: 0 })

  testToPrecision('-3.624323359112776296e-19', '-0.00000000000000000036243233591127762966338166', {
    sd: 19,
    rm: 0
  })

  testToPrecision('-68249040894032065692.62', '-68249040894032065692.62771690318493', {
    sd: 22,
    rm: 0
  })

  testToPrecision(
    '8786096722661914.89732851',
    '8786096722661914.89732851188880184891692993684242690315',
    { sd: 24, rm: 0 }
  )

  testToPrecision(
    '-1.8413321536281347264486372900000000000e-12',
    '-0.00000000000184133215362813472644863729',
    { sd: 38, rm: 0 }
  )

  testToPrecision('4.0e-9', '0.0000000040395827543504045', { sd: 2, rm: 0 })

  testToPrecision('-2.9427e+16', '-29427119846374896', { sd: 5, rm: 0 })

  testToPrecision('-917760614.4', '-917760614.45404359204911454', {
    sd: 10,
    rm: 0
  })

  testToPrecision('8e+4', '89427', { sd: 1, rm: 0 })

  testToPrecision('0.00000920323988134356953828667260', '0.0000092032398813435695382866726', {
    sd: 27,
    rm: 0
  })

  testToPrecision('8.2e+16', '82068995955708118', { sd: 2, rm: 0 })

  testToPrecision('3.35195944828e+26', '335195944828445911672446409.3379497158141', {
    sd: 12,
    rm: 0
  })

  testToPrecision(
    '-3.89774891030e-9',
    '-0.00000000389774891030223957363124620581272897758735065471',
    { sd: 12, rm: 0 }
  )

  testToPrecision('-4', '-4', { sd: 1, rm: 0 })

  testToPrecision('8', '8', { sd: 1, rm: 0 })

  testToPrecision(
    '1.41172955693912934219137966000000e-10',
    '0.000000000141172955693912934219137966',
    { sd: 33, rm: 0 }
  )

  testToPrecision('9.21481e+13', '92148111958857', { sd: 6, rm: 0 })

  testToPrecision('-5.859975978432853e-18', '-0.0000000000000000058599759784328539', {
    sd: 16,
    rm: 0
  })

  testToPrecision('-72.0', '-72', { sd: 3, rm: 0 })

  testToPrecision(
    '3785098751297.8929911950994079707157472',
    '3785098751297.89299119509940797071574729867819252140059',
    { sd: 38, rm: 0 }
  )

  testToPrecision('4.38e+16', '43893416753778361.297703358127215475077814', {
    sd: 3,
    rm: 0
  })

  testToPrecision('-33110.29096', '-33110.2909623520267070846514', {
    sd: 10,
    rm: 0
  })

  testToPrecision(
    '-74.38305251784882707720486436292121914036495',
    '-74.3830525178488270772048643629212191403649548392158614',
    { sd: 43, rm: 0 }
  )

  testToPrecision('-4.31091381814e+27', '-4310913818147299779611829988.1707181186375975966133328', {
    sd: 12,
    rm: 0
  })

  testToPrecision('-1e+7', '-19238355', { sd: 1, rm: 0 })

  testToPrecision('-8.203834974e+12', '-8203834974826.23347025', {
    sd: 10,
    rm: 0
  })

  testToPrecision('-7.4775e+5', '-747754.16564979702874976822', {
    sd: 5,
    rm: 0
  })

  testToPrecision('-9.291256959320e+23', '-929125695932058727753757.0232350927089256760451379', {
    sd: 13,
    rm: 0
  })

  testToPrecision('8.5e+11', '853985704471', { sd: 2, rm: 0 })

  testToPrecision('-6.6560212', '-6.65602121044617863313449309597493831', {
    sd: 8,
    rm: 0
  })

  testToPrecision('1785977942777.20398797', '1785977942777.2039879764361236566223563439', {
    sd: 21,
    rm: 0
  })

  testToPrecision('6.1333504356e+23', '613335043569565749922342.8859983523919141148812213832', {
    sd: 11,
    rm: 0
  })

  testToPrecision('-5.6e+8', '-565718507', { sd: 2, rm: 0 })

  testToPrecision('87732918932081', '87732918932081.5225691355449629111825', {
    sd: 14,
    rm: 0
  })

  testToPrecision('34510.55200915393645123', '34510.55200915393645123649', {
    sd: 22,
    rm: 0
  })

  testToPrecision(
    '80406604570281847.64813851700344044652354',
    '80406604570281847.648138517003440446523542379',
    { sd: 40, rm: 0 }
  )

  testToPrecision('4350.66340515', '4350.66340515436550356256', {
    sd: 12,
    rm: 0
  })

  testToPrecision(
    '-1.795651762606996e+19',
    '-17956517626069967584.285356976401607845756322546530214497',
    { sd: 16, rm: 0 }
  )

  testToPrecision('9.162e+24', '9162436195089050810891391.493612', {
    sd: 4,
    rm: 0
  })

  testToPrecision('-7.82552e+6', '-7825522.1080200627404337', { sd: 6, rm: 0 })

  testToPrecision('-358162040.1796393759838430', '-358162040.17963937598384303781972517649539', {
    sd: 25,
    rm: 0
  })

  testToPrecision('-20732451778.4', '-20732451778.464877395794562570976729066571095229', {
    sd: 12,
    rm: 0
  })

  testToPrecision('-239748.58739', '-239748.5873964402372997371903319', {
    sd: 11,
    rm: 0
  })

  testToPrecision('-6.106537e+9', '-6106537070.58700935776016694', {
    sd: 7,
    rm: 0
  })

  testToPrecision('4e+23', '405561947729011104089456.7617832102516', {
    sd: 1,
    rm: 0
  })

  testToPrecision('-1.7252987e+10', '-17252987633.58674364430598655792', {
    sd: 8,
    rm: 0
  })

  testToPrecision(
    '61.38960691398015334867512513960',
    '61.3896069139801533486751251396015198659145775291764',
    { sd: 31, rm: 0 }
  )

  testToPrecision('-891.3505', '-891.35058685025619', { sd: 7, rm: 0 })

  testToPrecision('1.5e+8', '153705028.906', { sd: 2, rm: 0 })

  testToPrecision('5.80e+18', '5805164734299168659.6173113885173384955443', {
    sd: 3,
    rm: 0
  })

  testToPrecision('-1.719875889271327', '-1.719875889271327133154458155573493605566221534', {
    sd: 16,
    rm: 0
  })

  testToPrecision('113.672129563', '113.672129563441659725876055771857758675550104070419635029', {
    sd: 12,
    rm: 0
  })

  testToPrecision(
    '-7.79500528146220810843979e+22',
    '-77950052814622081084397.91853869253589242574',
    { sd: 24, rm: 0 }
  )

  testToPrecision('4.53106985e+27', '4531069852787151785292512309.2901993579425172826443679877', {
    sd: 9,
    rm: 0
  })

  testToPrecision(
    '45285.246089613169416440797840714',
    '45285.2460896131694164407978407142422013937',
    { sd: 32, rm: 0 }
  )

  testToPrecision(
    '307760226411464.7333268079863299',
    '307760226411464.73332680798632996332324381779707',
    { sd: 31, rm: 0 }
  )

  testToPrecision('7.905300379788e+16', '79053003797878062.6454954', {
    sd: 13,
    rm: 1
  })

  testToPrecision('-6.83490000000e-13', '-0.00000000000068349', {
    sd: 12,
    rm: 1
  })

  testToPrecision('-62760641815.69084973661201201', '-62760641815.690849736612012010742308663', {
    sd: 28,
    rm: 1
  })

  testToPrecision('0.000704', '0.000704496313', { sd: 3, rm: 1 })

  testToPrecision(
    '82926865286287.8852357368342860830310721063079299643',
    '82926865286287.88523573683428608303107210630792996432',
    { sd: 51, rm: 1 }
  )

  testToPrecision(
    '-0.00032388272393900301214220090249',
    '-0.00032388272393900301214220090248744799603424908',
    { sd: 29, rm: 1 }
  )

  testToPrecision('8.6e+12', '8621641486938.4837308885005093571508566552428700982454', {
    sd: 2,
    rm: 1
  })

  testToPrecision('2', '2', { sd: 1, rm: 1 })

  testToPrecision('1.4641440117052559075e+20', '146414401170525590746.047955203899370771105088', {
    sd: 20,
    rm: 1
  })

  testToPrecision('3511.925583', '3511.925583', { sd: 10, rm: 1 })

  testToPrecision('2861824.253079699095728', '2861824.253079699095727765750377038689', {
    sd: 22,
    rm: 1
  })

  testToPrecision('-3.940097756e+10', '-39400977564.548924098664431671700066962', { sd: 10, rm: 1 })

  testToPrecision('-888', '-888', { sd: 3, rm: 1 })

  testToPrecision(
    '-0.000302106125213724988141721256104',
    '-0.00030210612521372498814172125610432438685',
    { sd: 30, rm: 1 }
  )

  testToPrecision(
    '6943.4804552555315615809650428503',
    '6943.480455255531561580965042850266831249032130818358478956',
    { sd: 32, rm: 1 }
  )

  testToPrecision('3365678', '3365678.3397481381125085749', { sd: 7, rm: 1 })

  testToPrecision('-5.3943374314e+19', '-53943374313769567458.386865325', {
    sd: 11,
    rm: 1
  })

  testToPrecision(
    '-6.67880509225510150542252852147049489938254298497979',
    '-6.6788050922551015054225285214704948993825429849797925563674',
    { sd: 51, rm: 1 }
  )

  testToPrecision('1.36424e+18', '1364240644139816224.60228356028', {
    sd: 6,
    rm: 1
  })

  testToPrecision(
    '1.410236477950416725e+23',
    '141023647795041672538410.84935693266374259666015274447',
    { sd: 19, rm: 1 }
  )

  testToPrecision('-802.817765', '-802.81776500697712984253334522', {
    sd: 9,
    rm: 1
  })

  testToPrecision(
    '-5.276210722424690668896260075355037218851',
    '-5.27621072242469066889626007535503721885096',
    { sd: 40, rm: 1 }
  )

  testToPrecision(
    '-0.000874209568970788',
    '-0.0008742095689707877849902027926289294748756775668387',
    { sd: 15, rm: 1 }
  )

  testToPrecision(
    '0.092053833162002',
    '0.09205383316200189249855864903410820435666385119723209239',
    { sd: 14, rm: 1 }
  )

  testToPrecision('7.0656298318128209e-14', '0.0000000000000706562983181282092835675843980510112', {
    sd: 17,
    rm: 1
  })

  testToPrecision('-8.66511516852116659e+18', '-8665115168521166587', {
    sd: 18,
    rm: 1
  })

  testToPrecision('3.3490648464e+22', '33490648463534229842937.79268276945692333064632966129475', {
    sd: 11,
    rm: 1
  })

  testToPrecision(
    '-39041587174692569176.82740706154183894',
    '-39041587174692569176.827407061541838942655371389185',
    { sd: 37, rm: 1 }
  )

  testToPrecision('-3834.0', '-3834', { sd: 5, rm: 1 })

  testToPrecision('-0.008912382644814418776268630', '-0.00891238264481441877626863', {
    sd: 25,
    rm: 1
  })

  testToPrecision('-2.1e+5', '-206119', { sd: 2, rm: 1 })

  testToPrecision('4.83340000000e-8', '0.000000048334', { sd: 12, rm: 1 })

  testToPrecision(
    '3.185196533675230520000000000000e-19',
    '0.000000000000000000318519653367523052',
    { sd: 31, rm: 1 }
  )

  testToPrecision(
    '6.0431217298488095562718496137220939447806000000000000000e-17',
    '0.000000000000000060431217298488095562718496137220939447806',
    { sd: 56, rm: 1 }
  )

  testToPrecision('196.519569070149034', '196.51956907014903416531531', {
    sd: 18,
    rm: 1
  })

  testToPrecision('0.0000046405006597117307566000', '0.0000046405006597117307566', {
    sd: 23,
    rm: 1
  })

  testToPrecision('9.10e+16', '90974867783311624.1073050261392195984211985571898902', {
    sd: 3,
    rm: 1
  })

  testToPrecision('0.0009', '0.0009', { sd: 1, rm: 1 })

  testToPrecision('-784.344', '-784.3442317667756502522526185951859933319162', {
    sd: 6,
    rm: 1
  })

  testToPrecision('4.407336482399797058693e+28', '44073364823997970586929155979.43263841350505', {
    sd: 22,
    rm: 1
  })

  testToPrecision('-3.0000000000e-13', '-0.0000000000003', { sd: 11, rm: 1 })

  testToPrecision('0.800', '0.8', { sd: 3, rm: 1 })

  testToPrecision(
    '0.04643398170143261158595951942031',
    '0.046433981701432611585959519420314960367263',
    { sd: 31, rm: 1 }
  )

  testToPrecision('-8e+26', '-786589693451258754942279859.3834', {
    sd: 1,
    rm: 1
  })

  testToPrecision('-26.0', '-26', { sd: 3, rm: 1 })

  testToPrecision('-8.462226728e+11', '-846222672789.2087639320702375427266333530942524245', {
    sd: 10,
    rm: 1
  })

  testToPrecision('-4e-7', '-0.0000004019666978288041783154210868', {
    sd: 1,
    rm: 1
  })

  testToPrecision('-315609.775843992', '-315609.775843992', { sd: 15, rm: 1 })

  testToPrecision('-3.319e+9', '-3318880945', { sd: 4, rm: 1 })

  testToPrecision('-6', '-6.2847', { sd: 1, rm: 1 })

  testToPrecision('7.754663772705e+20', '775466377270546647581.033426922028458904663', {
    sd: 13,
    rm: 1
  })

  testToPrecision(
    '-7.2577466365074249372160551716563e+25',
    '-72577466365074249372160551.71656300408',
    { sd: 32, rm: 1 }
  )

  testToPrecision('-7.8e+14', '-775743793612078', { sd: 2, rm: 1 })

  testToPrecision('132441.1194131940273344', '132441.119413194027334448511114274180643744', {
    sd: 22,
    rm: 1
  })

  testToPrecision('-2e+8', '-175718250.88225246544054572629398592939731158738360059', {
    sd: 1,
    rm: 1
  })

  testToPrecision('8603217351572193.39188696', '8603217351572193.391886964766947146712574336', {
    sd: 24,
    rm: 1
  })

  testToPrecision('-9.1544942231978215224e+22', '-91544942231978215224182.9277714', {
    sd: 20,
    rm: 1
  })

  testToPrecision('2.67483212861962e+22', '26748321286196185405759.132664', {
    sd: 15,
    rm: 1
  })

  testToPrecision('-5812371.3', '-5812371.311809024582418495005304074', {
    sd: 8,
    rm: 1
  })

  testToPrecision('-4.56681272e+10', '-45668127184.1622', { sd: 9, rm: 1 })

  testToPrecision('-6.833879652430027734e+28', '-68338796524300277341620461049.174596381', {
    sd: 19,
    rm: 1
  })

  testToPrecision('3.5253e+11', '352531868532', { sd: 5, rm: 1 })

  testToPrecision('6.18754e+9', '6187538472.1814915517411034136013806202710623466754380762318', {
    sd: 6,
    rm: 1
  })

  testToPrecision(
    '-4.91199142018364313968271511239982195e+28',
    '-49119914201836431396827151123.99821949990542',
    { sd: 36, rm: 1 }
  )

  testToPrecision('-2.50e+18', '-2498994955335714645.22910610209', {
    sd: 3,
    rm: 1
  })

  testToPrecision(
    '112714.50647532453078481574527706184222476885',
    '112714.50647532453078481574527706184222476884905812',
    { sd: 44, rm: 1 }
  )

  testToPrecision('1.3e+10', '13358297773', { sd: 2, rm: 1 })

  testToPrecision('3.85346866600e+27', '3853468666000315958109987025.078941', {
    sd: 12,
    rm: 1
  })

  testToPrecision('-6.849e+16', '-68490080550892289', { sd: 4, rm: 1 })

  testToPrecision('9.095', '9.094726073939375', { sd: 4, rm: 1 })

  testToPrecision('4.6722099483e+12', '4672209948311.8638324115985415208264055834', {
    sd: 11,
    rm: 1
  })

  testToPrecision(
    '-75494281.3585391383',
    '-75494281.3585391382541907932608754414663476859104837422712',
    { sd: 18, rm: 1 }
  )

  testToPrecision('7.9e+2', '787.7709059965548561711769118765', {
    sd: 2,
    rm: 1
  })

  testToPrecision('6103081090513.979878497219802', '6103081090513.9798784972198017843', {
    sd: 28,
    rm: 1
  })

  testToPrecision(
    '-6207456599626114.392919',
    '-6207456599626114.39291886624528055513014220851925',
    { sd: 22, rm: 1 }
  )

  testToPrecision(
    '844941600554602638837.461606663208684075561936',
    '844941600554602638837.461606663208684075561935576396',
    { sd: 45, rm: 1 }
  )

  testToPrecision('159438905444627555.28986', '159438905444627555.28985729196359392', {
    sd: 23,
    rm: 1
  })

  testToPrecision(
    '-3688253681705278.414841830526919796661181971979',
    '-3688253681705278.4148418305269197966611819719792068915',
    { sd: 46, rm: 1 }
  )

  testToPrecision('-63', '-63.164640732796214571844119', { sd: 2, rm: 1 })

  testToPrecision('2.8e+11', '276059026705.36069', { sd: 2, rm: 1 })

  testToPrecision(
    '357378.987253867425946425403370727230144',
    '357378.9872538674259464254033707272301441754336',
    { sd: 39, rm: 1 }
  )

  testToPrecision('1597.52674152596523825479', '1597.526741525965238254790848976407269408999607', {
    sd: 24,
    rm: 1
  })

  testToPrecision('4.63310587686706257280646279e+30', '4633105876867062572806462788592.801009', {
    sd: 27,
    rm: 1
  })

  testToPrecision('-6.21108762339449e+20', '-621108762339448671355.1393522133', { sd: 15, rm: 1 })

  testToPrecision('8380435.063269894549337249', '8380435.063269894549337248813357930541546715547', {
    sd: 25,
    rm: 1
  })

  testToPrecision('0.08000', '0.08', { sd: 4, rm: 2 })

  testToPrecision('-4.5132e+21', '-4513243388120382069815.8508153058993058875', { sd: 5, rm: 2 })

  testToPrecision('-73549', '-73549.2594630551663822238', { sd: 5, rm: 2 })

  testToPrecision('1.275868004728922895890883e+29', '127586800472892289589088296800.6', {
    sd: 25,
    rm: 2
  })

  testToPrecision(
    '-0.0003715444034899460421534099962225699000',
    '-0.0003715444034899460421534099962225699',
    { sd: 37, rm: 2 }
  )

  testToPrecision('-6.9625565265e+24', '-6962556526511822306135536', {
    sd: 11,
    rm: 2
  })

  testToPrecision('1.67583703641e+13', '16758370364138.915293525076269061228714877', {
    sd: 12,
    rm: 2
  })

  testToPrecision(
    '-173594.95064085553515176707313947534918109631092170',
    '-173594.950640855535151767073139475349181096310921699',
    { sd: 50, rm: 2 }
  )

  testToPrecision('-6.9503965525e+19', '-69503965525000308384.151383', {
    sd: 11,
    rm: 2
  })

  testToPrecision('4.411225e+20', '441122486054080817112', { sd: 7, rm: 2 })

  testToPrecision('2.467044064783596937642371770e+31', '24670440647835969376423717700462.39', {
    sd: 28,
    rm: 2
  })

  testToPrecision(
    '3.9711897549481645654e+24',
    '3971189754948164565361634.8039734590476326224193520402091769',
    { sd: 20, rm: 2 }
  )

  testToPrecision(
    '-1.4757613208690e+21',
    '-1475761320868963235919.64499841336073105746686372924161',
    { sd: 14, rm: 2 }
  )

  testToPrecision('91683083887068.6191146', '91683083887068.61911461351134520171343337804061135', {
    sd: 21,
    rm: 2
  })

  testToPrecision('-7923074181102822.578', '-7923074181102822.5778', {
    sd: 19,
    rm: 2
  })

  testToPrecision('-6.800e-8', '-0.000000068', { sd: 4, rm: 2 })

  testToPrecision('-2.57954671081460000000e-10', '-0.00000000025795467108146', {
    sd: 21,
    rm: 2
  })

  testToPrecision('5.5352911972e-9', '0.000000005535291197169667611325365189624523452', {
    sd: 11,
    rm: 2
  })

  testToPrecision('6.0488358e+8', '604883577', { sd: 8, rm: 2 })

  testToPrecision('3', '3', { sd: 1, rm: 2 })

  testToPrecision(
    '-4.072637936805672015603149446630136089530560102165',
    '-4.0726379368056720156031494466301360895305601021653459970194',
    { sd: 49, rm: 2 }
  )

  testToPrecision('-7.2e+10', '-71689970391', { sd: 2, rm: 2 })

  testToPrecision('655754242958.1563938760094919', '655754242958.15639387600949190369', {
    sd: 28,
    rm: 2
  })

  testToPrecision('-7.575535014e-9', '-0.00000000757553501363609536678641245355', { sd: 10, rm: 2 })

  testToPrecision(
    '7.547067960578900230644488e-10',
    '0.00000000075470679605789002306444877998602723',
    { sd: 25, rm: 2 }
  )

  testToPrecision('-3.64561456763e+12', '-3645614567625.4', { sd: 12, rm: 2 })

  testToPrecision('9.0e-7', '0.0000009', { sd: 2, rm: 2 })

  testToPrecision('7e+2', '687', { sd: 1, rm: 2 })

  testToPrecision(
    '517277827334839.8174848543680868',
    '517277827334839.8174848543680868015165926618',
    { sd: 31, rm: 2 }
  )

  testToPrecision('7e+2', '655.46270361324473194', { sd: 1, rm: 2 })

  testToPrecision(
    '1632131488313153.49737424823493573157',
    '1632131488313153.497374248234935731568',
    { sd: 36, rm: 2 }
  )

  testToPrecision(
    '274068317992.5998880719845028748169734442',
    '274068317992.5998880719845028748169734442394151076',
    { sd: 40, rm: 2 }
  )

  testToPrecision('-7.060e-9', '-0.00000000706025531009734073', {
    sd: 4,
    rm: 2
  })

  testToPrecision('0.004444', '0.0044439457493', { sd: 4, rm: 2 })

  testToPrecision(
    '7.2482770689153111154104782082023e+28',
    '72482770689153111154104782082.022764082943227214833851',
    { sd: 32, rm: 2 }
  )

  testToPrecision('5.9130694036072794206e+24', '5913069403607279420613864.152', { sd: 20, rm: 2 })

  testToPrecision('8.43384561300245347961437966e+23', '843384561300245347961437.96592523791', {
    sd: 27,
    rm: 2
  })

  testToPrecision('0.0000035198821282510000000', '0.000003519882128251', {
    sd: 20,
    rm: 2
  })

  testToPrecision('-1.00371560130267706870097e-9', '-0.00000000100371560130267706870096885251', {
    sd: 24,
    rm: 2
  })

  testToPrecision('17504218.4970302', '17504218.49703016415913667026121376499', { sd: 15, rm: 2 })

  testToPrecision('-5e-9', '-0.000000005169058703', { sd: 1, rm: 2 })

  testToPrecision('6.922803246e+10', '69228032455', { sd: 10, rm: 2 })

  testToPrecision('-16', '-16', { sd: 2, rm: 2 })

  testToPrecision(
    '-1.355147513468192707127939151e+40',
    '-13551475134681927071279391508441439066206.58705380600075',
    { sd: 28, rm: 2 }
  )

  testToPrecision('81670324.1197758695', '81670324.1197758695212865075629796973196504241126', {
    sd: 18,
    rm: 2
  })

  testToPrecision('0.00005', '0.00004797485174640366805332660647', {
    sd: 1,
    rm: 2
  })

  testToPrecision('-4.864397594e-10', '-0.0000000004864397594461335282648538530108953965681345', {
    sd: 10,
    rm: 2
  })

  testToPrecision('47694105.2312532', '47694105.23125322528167211284521303', {
    sd: 15,
    rm: 2
  })

  testToPrecision('-4.962106181e+26', '-496210618135432953927871636.779236', {
    sd: 10,
    rm: 2
  })

  testToPrecision('1.2800030559497062236642e+37', '12800030559497062236641930592334626609.7332', {
    sd: 23,
    rm: 2
  })

  testToPrecision('-574830783.7', '-574830783.6689168903917696583746514637433390929', {
    sd: 10,
    rm: 2
  })

  testToPrecision('5969.431086199057470', '5969.43108619905746956015212970904111744101', {
    sd: 19,
    rm: 2
  })

  testToPrecision('-4.8e+3', '-4814.32904953003285', { sd: 2, rm: 2 })

  testToPrecision('4.297e+16', '42973001760252134', { sd: 4, rm: 2 })

  testToPrecision('-5.7628e+6', '-5762846.590152347665179652381407653797146356303622218259885', {
    sd: 5,
    rm: 2
  })

  testToPrecision(
    '904864662232032.160612401810317927291657403142932',
    '904864662232032.16061240181031792729165740314293194205879163',
    { sd: 48, rm: 2 }
  )

  testToPrecision('7.9892e+20', '798923115068265241915.537619430376605', {
    sd: 5,
    rm: 2
  })

  testToPrecision('-8.97759349384000643', '-8.97759349384000643427096282979', {
    sd: 18,
    rm: 2
  })

  testToPrecision('841598023200278219780', '841598023200278219780.04764720909930685', {
    sd: 21,
    rm: 2
  })

  testToPrecision('7.294115e+17', '729411462980818078', { sd: 7, rm: 2 })

  testToPrecision('-493854.469231', '-493854.46923056217873', {
    sd: 12,
    rm: 2
  })

  testToPrecision('1.16760483177812e+16', '11676048317781198.761924013', {
    sd: 15,
    rm: 2
  })

  testToPrecision('4.91431629960536e+17', '491431629960536053.49611060493021241774', {
    sd: 15,
    rm: 2
  })

  testToPrecision(
    '-3.913572045646832654662206785248961969115394056441165e+26',
    '-391357204564683265466220678.524896196911539405644116478',
    { sd: 52, rm: 2 }
  )

  testToPrecision(
    '-1138622.4269179222525707405725062065185867',
    '-1138622.42691792225257074057250620651858665807616',
    { sd: 41, rm: 2 }
  )

  testToPrecision(
    '7.76249141450727328958717460526e+24',
    '7762491414507273289587174.60526424654003',
    { sd: 30, rm: 2 }
  )

  testToPrecision('-8.34305e+12', '-8343051798787.85784573983', {
    sd: 6,
    rm: 2
  })

  testToPrecision('-448090139696.5', '-448090139696.540044682', {
    sd: 13,
    rm: 2
  })

  testToPrecision(
    '-249554483941810.04760758280384259798256931579',
    '-249554483941810.0476075828038425979825693157901967215767',
    { sd: 44, rm: 2 }
  )

  testToPrecision('-4937249656843391.056849', '-4937249656843391.056849458', {
    sd: 22,
    rm: 2
  })

  testToPrecision('-4.90029240789e+24', '-4900292407887576632220011.4', {
    sd: 12,
    rm: 2
  })

  testToPrecision('884134', '884134.30546381722', { sd: 6, rm: 2 })

  testToPrecision('-67686.285431006', '-67686.2854310057290328136776917246126204655', {
    sd: 14,
    rm: 2
  })

  testToPrecision('5.1454907927786956678e+21', '5145490792778695667848.5080878826658832100351133', {
    sd: 20,
    rm: 2
  })

  testToPrecision('-3.75540093e+9', '-3755400930.115945946791361377756114557824815082', {
    sd: 9,
    rm: 2
  })

  testToPrecision('790548.1', '790548.055405', { sd: 7, rm: 2 })

  testToPrecision('21.9776441681934305611827', '21.9776441681934305611826542081066055', {
    sd: 24,
    rm: 2
  })

  testToPrecision('-8.62915591e+12', '-8629155908036.5010483', {
    sd: 9,
    rm: 2
  })

  testToPrecision('-62521191175', '-62521191175.03721539877599449', {
    sd: 11,
    rm: 2
  })

  testToPrecision('-6.394701017023514561889355048e+22', '-63947010170235145618893.55048264587643', {
    sd: 28,
    rm: 2
  })

  testToPrecision('-4.4791e+5', '-447912.9929543492037', { sd: 5, rm: 2 })

  testToPrecision('876897.06887720787797443065', '876897.0688772078779744306464727', {
    sd: 26,
    rm: 2
  })

  testToPrecision(
    '-609834676.749497163216150672711104329822616519',
    '-609834676.749497163216150672711104329822616518762',
    { sd: 45, rm: 2 }
  )

  testToPrecision('-2.9407315435e+18', '-2940731543474095094.56340709357589521', { sd: 11, rm: 2 })

  testToPrecision(
    '243028.94040290384317164750687246',
    '243028.940402903843171647506872458168411478',
    { sd: 32, rm: 2 }
  )

  testToPrecision('5313610990.737', '5313610990.7373810218', { sd: 13, rm: 2 })

  testToPrecision('-3.56e+4', '-35566.4678487', { sd: 3, rm: 2 })

  testToPrecision('123.45', '12.345e1', { sd: undefined, rm: 2 })

  testToPrecision('7.905300379788e+16', '79053003797878062.6454954', {
    sd: 13,
    rm: 3
  })

  testToPrecision('-6.83490000000e-13', '-0.00000000000068349', {
    sd: 12,
    rm: 3
  })

  testToPrecision('-62760641815.69084973661201202', '-62760641815.690849736612012010742308663', {
    sd: 28,
    rm: 3
  })

  testToPrecision('0.000705', '0.000704496313', { sd: 3, rm: 3 })

  testToPrecision(
    '82926865286287.8852357368342860830310721063079299644',
    '82926865286287.88523573683428608303107210630792996432',
    { sd: 51, rm: 3 }
  )

  testToPrecision(
    '-0.00032388272393900301214220090249',
    '-0.00032388272393900301214220090248744799603424908',
    { sd: 29, rm: 3 }
  )

  testToPrecision('8.7e+12', '8621641486938.4837308885005093571508566552428700982454', {
    sd: 2,
    rm: 3
  })

  testToPrecision('2', '2', { sd: 1, rm: 3 })

  testToPrecision('1.4641440117052559075e+20', '146414401170525590746.047955203899370771105088', {
    sd: 20,
    rm: 3
  })

  testToPrecision('3511.925583', '3511.925583', { sd: 10, rm: 3 })

  testToPrecision('2861824.253079699095728', '2861824.253079699095727765750377038689', {
    sd: 22,
    rm: 3
  })

  testToPrecision('-3.940097757e+10', '-39400977564.548924098664431671700066962', { sd: 10, rm: 3 })

  testToPrecision('-888', '-888', { sd: 3, rm: 3 })

  testToPrecision(
    '-0.000302106125213724988141721256105',
    '-0.00030210612521372498814172125610432438685',
    { sd: 30, rm: 3 }
  )

  testToPrecision(
    '6943.4804552555315615809650428503',
    '6943.480455255531561580965042850266831249032130818358478956',
    { sd: 32, rm: 3 }
  )

  testToPrecision('3365679', '3365678.3397481381125085749', { sd: 7, rm: 3 })

  testToPrecision('-5.3943374314e+19', '-53943374313769567458.386865325', {
    sd: 11,
    rm: 3
  })

  testToPrecision(
    '-6.67880509225510150542252852147049489938254298497980',
    '-6.6788050922551015054225285214704948993825429849797925563674',
    { sd: 51, rm: 3 }
  )

  testToPrecision('1.36425e+18', '1364240644139816224.60228356028', {
    sd: 6,
    rm: 3
  })

  testToPrecision(
    '1.410236477950416726e+23',
    '141023647795041672538410.84935693266374259666015274447',
    { sd: 19, rm: 3 }
  )

  testToPrecision('-802.817766', '-802.81776500697712984253334522', {
    sd: 9,
    rm: 3
  })

  testToPrecision(
    '-5.276210722424690668896260075355037218851',
    '-5.27621072242469066889626007535503721885096',
    { sd: 40, rm: 3 }
  )

  testToPrecision(
    '-0.000874209568970788',
    '-0.0008742095689707877849902027926289294748756775668387',
    { sd: 15, rm: 3 }
  )

  testToPrecision(
    '0.092053833162002',
    '0.09205383316200189249855864903410820435666385119723209239',
    { sd: 14, rm: 3 }
  )

  testToPrecision('7.0656298318128210e-14', '0.0000000000000706562983181282092835675843980510112', {
    sd: 17,
    rm: 3
  })

  testToPrecision('-8.66511516852116659e+18', '-8665115168521166587', {
    sd: 18,
    rm: 3
  })

  testToPrecision('3.3490648464e+22', '33490648463534229842937.79268276945692333064632966129475', {
    sd: 11,
    rm: 3
  })

  testToPrecision(
    '-39041587174692569176.82740706154183895',
    '-39041587174692569176.827407061541838942655371389185',
    { sd: 37, rm: 3 }
  )

  testToPrecision('-3834.0', '-3834', { sd: 5, rm: 3 })

  testToPrecision('-0.008912382644814418776268630', '-0.00891238264481441877626863', {
    sd: 25,
    rm: 3
  })

  testToPrecision('-2.1e+5', '-206119', { sd: 2, rm: 3 })

  testToPrecision('4.83340000000e-8', '0.000000048334', { sd: 12, rm: 3 })

  testToPrecision(
    '3.185196533675230520000000000000e-19',
    '0.000000000000000000318519653367523052',
    { sd: 31, rm: 3 }
  )

  testToPrecision(
    '6.0431217298488095562718496137220939447806000000000000000e-17',
    '0.000000000000000060431217298488095562718496137220939447806',
    { sd: 56, rm: 3 }
  )

  testToPrecision('196.519569070149035', '196.51956907014903416531531', {
    sd: 18,
    rm: 3
  })

  testToPrecision('0.0000046405006597117307566000', '0.0000046405006597117307566', {
    sd: 23,
    rm: 3
  })

  testToPrecision('9.10e+16', '90974867783311624.1073050261392195984211985571898902', {
    sd: 3,
    rm: 3
  })

  testToPrecision('0.0009', '0.0009', { sd: 1, rm: 3 })

  testToPrecision('-784.345', '-784.3442317667756502522526185951859933319162', {
    sd: 6,
    rm: 3
  })

  testToPrecision('4.407336482399797058693e+28', '44073364823997970586929155979.43263841350505', {
    sd: 22,
    rm: 3
  })

  testToPrecision('-3.0000000000e-13', '-0.0000000000003', { sd: 11, rm: 3 })

  testToPrecision('0.800', '0.8', { sd: 3, rm: 3 })

  testToPrecision(
    '0.04643398170143261158595951942032',
    '0.046433981701432611585959519420314960367263',
    { sd: 31, rm: 3 }
  )

  testToPrecision('-8e+26', '-786589693451258754942279859.3834', {
    sd: 1,
    rm: 3
  })

  testToPrecision('-26.0', '-26', { sd: 3, rm: 3 })

  testToPrecision('-8.462226728e+11', '-846222672789.2087639320702375427266333530942524245', {
    sd: 10,
    rm: 3
  })

  testToPrecision('-5e-7', '-0.0000004019666978288041783154210868', {
    sd: 1,
    rm: 3
  })

  testToPrecision('-315609.775843992', '-315609.775843992', { sd: 15, rm: 3 })

  testToPrecision('-3.319e+9', '-3318880945', { sd: 4, rm: 3 })

  testToPrecision('-7', '-6.2847', { sd: 1, rm: 3 })

  testToPrecision('7.754663772706e+20', '775466377270546647581.033426922028458904663', {
    sd: 13,
    rm: 3
  })

  testToPrecision(
    '-7.2577466365074249372160551716564e+25',
    '-72577466365074249372160551.71656300408',
    { sd: 32, rm: 3 }
  )
})
